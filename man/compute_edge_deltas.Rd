% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/edge_scoring.R
\name{compute_edge_deltas}
\alias{compute_edge_deltas}
\title{Compute delta scores for edge reorientation (MIIC_search&score – Step 2)}
\usage{
compute_edge_deltas(edge_list, adj, data, hash_table)
}
\arguments{
\item{edge_list}{A data frame with two columns 'Node1' and 'Node2', specifying candidate edges to reorient.}

\item{adj}{A square adjacency matrix using MIIC conventions:
\itemize{
\item 2 = parent
\item -2 = child
\item 6 = bidirected
\item 1 = undirected
\item 0 = no edge
}}

\item{data}{A data frame containing the observed variables (columns) and samples (rows).}

\item{hash_table}{An environment or named list used to cache conditional mutual information values.}
}
\value{
A list with:
\describe{
\item{edge_deltas}{A data frame with columns 'X', 'Y', 'delta', and 'op', where \code{op} indicates the optimal orientation:
0 = no change, 1 = X <- Y, 2 = X -> Y, 3 = X <-> Y.}
\item{hash_table}{The updated cache of mutual information computations.}
}
}
\description{
This function implements \strong{Step 2} of the MIIC_search&score algorithm.
For each edge (X, Y), it evaluates whether reorienting the edge improves the global score,
based on a decomposition of the log-likelihood into local mutual information contributions.
}
\details{
\subsection{Delta score definition}{

For each edge, three scores are computed based on conditional mutual information:
\itemize{
\item \code{X <- Y} (op = 1): \eqn{-I(Y ; X | Pa'_X)}
\item \code{X -> Y} (op = 2): \eqn{-I(X ; Y | Pa'_Y)}
\item \code{X <-> Y} (op = 3): \eqn{-I(X ; Y | Pa'_X ∪ Pa'_Y)}
}
where \eqn{Pa'_X = Pa(X) \ Y} and \eqn{Pa'_Y = Pa(Y) \ X}.

The delta score is defined as:
\deqn{\delta = \min(score_{YX}, score_{XY}, score_{latent}) - score_{current}}
If all scores are equal, no change is suggested (\code{delta = 0}, \code{op = 0}).
}

\subsection{Acyclicity constraint}{

Reorientations that would introduce cycles are automatically blocked by checking
ancestor relationships: if \eqn{X \in Anc(Y)}, then \eqn{Y \rightarrow X} is forbidden, and vice versa.
}
}
\references{
Lagrange, N. and Isambert, H. (2025).
An efficient search-and-score algorithm for ancestral graphs using multivariate information scores.
In \emph{Proceedings of the 42nd International Conference on Machine Learning (ICML 2025)}.
}
